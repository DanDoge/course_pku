### 网络层

支持vlan的switch发给不支持vlan的switch会untag



实现

- 点对点的通信
- 每一个主机和路由器上面都有网路层协议
- 路由器决定转发路径
- 主要功能：路由和转发
- 两种服务
    - 虚电路：指定主叫被叫
        - 先呼叫，之后拆除电路，每一个分组携带VC标识，每一个路由器都维护连接状态，分配连接资源，流量控制和差错控制，分组经过路由器之后VC标识改变
        - 差错控制：路由器缓存数据包，确认了再丢掉
        - 建立虚电路之后的数据报就没有源和目的地址了，分组头就很小
    - 数据报
        - 只有转发和路由功能，有ttl，可能后发先到，没有差错和流量控制
- 路由器：转发分组
    - 输入端口：物理层处理，链路层处理（接受目的是自己的帧），网络层排队
    - 交换结构：存储器，总线（转发吞吐量减半：数据报进出两次，竞争总线），互联网络
    - 输入端口排队：前部阻塞：看图更清楚
        - 高速交换：先拆分成短分组，发完再整合
        - 虚拟输出队列：每一个入口都按出口排队，找一个不冲突的输入输出匹配
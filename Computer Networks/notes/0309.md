链路层功能

- 建立/拆除链路
- 同步：组帧/解帧
- 流量控制：收端控制发端
- 差错控制：信道编码技术
- 透明传输



链路层

- 链路：相邻节点之间的信道
- 帧：链路上传输数据的基本单位
- 主机上实现，网卡实现链路层和物理层
    - 串并变换：并行数据->串行信号
- 同步，收发双方协调收发动作，两种同步方法
    - 异步传输：字符为传输单位，字符间隔可变，字符内各位速率固定
        - RS232：0-1跳变代表传输开始，发一个字符，之后静默。接收端怎么提取时钟？收端用发端声称的波特率采样，这两个（不同源的）时钟可能不同，采样可能出错
        - 帧长不能太长，数据率不能太高
    - 同步传输：每一位都同步，按位传输，收端提取发端的时钟
        - 时钟同源：可能时钟线发给收端，或者收端提取时钟，再采样
        - 帧可以更长，效率高，帧首尾标志
        - 以太帧：8字节同步头101010...1011，src，tgt，type，data，FCS
- 组帧技术
    - 字节计数/固定长度/标志位
    - 字节技术：头部字段标识帧字节数：可能有干扰！
    - 封装帧头/帧尾：帧开头0x01，结束0x04
        - 如何保证帧头帧尾在数据部分不会出现？在前面加一个ESC 0x1B，ESC前面也加一个ESC
        - 或者比特填充，帧标志0x7E，如果帧中出现5个连1插一个0，收端删掉这个0
- 错帧检测
    - 插一些冗余位
    - 奇偶校验：使得最终1的个数为奇/偶，二维奇偶校验：组成矩阵行列都查一查，可以纠正一位的错
    - 编码是增大各个可行的码字之间的距离，解码是找到最近的码字，距离按照汉明码距定义
    - 检测d位错，码距应该是d+1，纠正d位错，码距应当是2d+1
    - 汉明码：校验位（偶校验）位于2^n，其他的是信息位，校验按binary indexed tree定义，可以纠正1位错
    - 交织：定义突发长度（第一个错到最后一位错的长度），信息位组织成n列k行，时间上连续的错打散成离散的
    - CRC：让D concat R模G得0，检测突发长度小于等于r位得错误